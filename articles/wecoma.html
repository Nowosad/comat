<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A weighted co-occurrence matrix (wecoma) representation â€¢ comat</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A weighted co-occurrence matrix (wecoma) representation">
<meta property="og:description" content="comat">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">comat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/coma.html">A co-occurrence matrix (coma) representation</a>
    </li>
    <li>
      <a href="../articles/incoma.html">An integrated co-occurrence matrix (incoma) representation</a>
    </li>
    <li>
      <a href="../articles/wecoma.html">A weighted co-occurrence matrix (wecoma) representation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Nowosad/comat/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A weighted co-occurrence matrix (wecoma) representation</h1>
                        <h4 class="author">Jakub Nowosad</h4>
            
            <h4 class="date">2021-03-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Nowosad/comat/blob/master/vignettes/wecoma.Rmd"><code>vignettes/wecoma.Rmd</code></a></small>
      <div class="hidden name"><code>wecoma.Rmd</code></div>

    </div>

    
    
<p>This vignette explains what a weighted co-occurrence matrix (<em>wecoma</em>) representation is and how to calculate it using the <strong>comat</strong> package. If you do not know what a co-occurrence matrix is, it could be worth to read <a href="coma.html">the first package vignette</a> first. The examples below assume the <strong>comat</strong> package is attached, and the <code>raster_x</code> and <code>raster_w</code> datasets are loaded:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">comat</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">raster_x</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"comat"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">raster_w</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"comat"</span>)</pre></body></html></div>
<p>The <code>raster_x</code> object is a matrix with three rows and columns with values of 1, 2, and 3.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">raster_x</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]    1    1    3</span>
<span class="co">#&gt; [2,]    1    3    3</span>
<span class="co">#&gt; [3,]    2    2    3</span></pre></body></html></div>
<p>We can imagine that the value of 1 (blueish color) represents population A, the value of 2 (dark green) is population B, and the value of 3 (light green) represents population C.</p>
<p><img src="wecoma_files/figure-html/unnamed-chunk-3-1.png" width="384"></p>
<p>The <code>raster_w</code> object is also a matrix of the same dimensions. It has values between 2 and 9.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">raster_w</span>
<span class="co">#&gt;      [,1] [,2] [,3]</span>
<span class="co">#&gt; [1,]    2    2    9</span>
<span class="co">#&gt; [2,]    6    4    9</span>
<span class="co">#&gt; [3,]    4    8    9</span></pre></body></html></div>
<p>This object is different from the first one, as it does not represent categories. Its role is to provide some weights to the previous raster. We can think of it as a number of occurrences in each population.</p>
<p><img src="wecoma_files/figure-html/unnamed-chunk-5-1.png" width="384"></p>
<p>The weighted co-occurrence matrix (<em>wecoma</em>) representation is a modification of the co-occurrence matrix (<em>coma</em>). In the co-occurrence matrix, each adjacency contributes to the output with the constant value 1. In the weighted co-occurrence matrix, on the other hand, each adjacency contributes to the output based on the values from the weight matrix. The contributed value is calculated as the average of the weights in the two adjacent cells.</p>
<p>We can use the <code><a href="../reference/get_wecoma.html">get_wecoma()</a></code> function to calculate this weighted co-occurrence matrix (<em>wecoma</em>) representation:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/get_wecoma.html">get_wecoma</a></span>(<span class="no">raster_x</span>, <span class="no">raster_w</span>)
<span class="co">#&gt;      1    2    3</span>
<span class="co">#&gt; 1 12.0  5.0 13.5</span>
<span class="co">#&gt; 2  5.0 12.0 14.5</span>
<span class="co">#&gt; 3 13.5 14.5 49.0</span></pre></body></html></div>
<p>In this representation, we do not count the neighbors but sum the contributed values from the weight matrix. The smallest value (5) represents the relation between the adjacent cells between the first and the second category. This is due to the relatively small values of the neighborhooding cells of these classes, but also because there is only one case of adjacent cells of these classes. Central left cell (blueish, category 1) has a value of 6, and the bottom left cell (dark green, category 2) has a value of 4. The output value, 5, is an average of the two adjacent weights. On the other hand, a light green region has the largest values in the weight matrix. Therefore, the output of the <code><a href="../reference/get_wecoma.html">get_wecoma()</a></code> function has the largest value (49) for the relation between the adjacent cells of the third category.</p>
<p>This function allows for some parametrization using additional arguments - <code>fun</code> and <code>na_action</code>. The <code>fun</code> argument selects the function to calculate values from adjacent cells to contribute to the output matrix. It has three possible options: <code>"mean"</code> - calculate average values from adjacent cells of the weight matrix, <code>"geometric_mean"</code> - calculate geometric mean values from adjacent cells of the weight matrix, or <code>"focal"</code> assign a value from the focal cell. The <code>na_action</code> argument decides on how to behave in the presence of missing values in the weight matrix. The default, <code>"replace"</code>, replaces missing values with 0, <code>"omit"</code> does not use cells with missing values, and <code>"keep"</code> keeps missing values.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/get_wecoma.html">get_wecoma</a></span>(<span class="no">raster_x</span>, <span class="no">raster_w</span>, <span class="kw">fun</span> <span class="kw">=</span> <span class="st">"focal"</span>, <span class="kw">na_action</span> <span class="kw">=</span> <span class="st">"omit"</span>)
<span class="co">#&gt;    1  2  3</span>
<span class="co">#&gt; 1 12  6 10</span>
<span class="co">#&gt; 2  4 12 16</span>
<span class="co">#&gt; 3 17 13 49</span></pre></body></html></div>
<p>Similarly to the co-occurrence matrix (<em>coma</em>), it is possible to convert <em>wecoma</em> to its 1D representation. This new form is called a weighted co-occurrence vector (<em>wecove</em>), and can be created using the <code><a href="../reference/get_wecove.html">get_wecove()</a></code> function, which accepts an output of <code><a href="../reference/get_wecoma.html">get_wecoma()</a></code>:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">my_wecoma</span> <span class="kw">=</span> <span class="fu"><a href="../reference/get_wecoma.html">get_wecoma</a></span>(<span class="no">raster_x</span>, <span class="no">raster_w</span>)
<span class="fu"><a href="../reference/get_wecove.html">get_wecove</a></span>(<span class="no">my_wecoma</span>, <span class="kw">normalization</span> <span class="kw">=</span> <span class="st">"pdf"</span>)
<span class="co">#&gt;            [,1]       [,2]      [,3]       [,4]       [,5]      [,6]      [,7]</span>
<span class="co">#&gt; [1,] 0.08633094 0.03597122 0.0971223 0.03597122 0.08633094 0.1043165 0.0971223</span>
<span class="co">#&gt;           [,8]     [,9]</span>
<span class="co">#&gt; [1,] 0.1043165 0.352518</span></pre></body></html></div>
<p>You can see the weighted co-occurrence matrix (<em>wecoma</em>) concept, there described as an <em>exposure matrix</em>, in action in the vignettes of the <strong>raceland</strong> package (Nowosad, Dmowska, and Stepinski, 2020):</p>
<ol style="list-style-type: decimal">
<li><a href="https://nowosad.github.io/raceland/articles/raceland-intro1.html">raceland: R package for a pattern-based, zoneless method for analysis and visualization of racial topography</a></li>
<li><a href="https://nowosad.github.io/raceland/articles/raceland-intro2.html">raceland: Describing local racial patterns of racial landscapes at different spatial scales</a></li>
<li><a href="https://nowosad.github.io/raceland/articles/raceland-intro3.html">raceland: Describing local pattern of racial landscape using SocScape grids</a></li>
</ol>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li>Jakub Nowosad, Anna Dmowska and Tomasz Stepinski (2020). raceland: Pattern-Based Zoneless Method for Analysis and Visualization of Racial Topography. R package version 1.0.5. <a href="https://CRAN.R-project.org/package=raceland" class="uri">https://CRAN.R-project.org/package=raceland</a>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jakub Nowosad.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
